문제 이름은 Question Forgotten past이고 풀이과정은 다음과 같다. 전체적으로 robots.txt를 강조하는 문구가 많다. 접속해서 살펴보면 User-agent: * Disallow: /old_site/라는 경로가 있고 해당 경로로 접근하여 login 소스코드를 살펴보면 계정 정보가 노출되어 있다. 해당 계정으로 로그인하면 플래그를 얻을 수 있다. 얻은 플래그는 FLAG{d0n'7_f0rg37_7h3_0ld_r0807}이다. 문제 이름은 Shadow of the system이고 풀이과정은 다음과 같다. 주어진 system 파일을 regripper로 분석하여 의심 문자열을 발견할 수 있다. 얻은 플래그는 FLAG{8yp455_u4c_g37_5y5t3m}이다. 문제 이름은 watch이고 풀이과정은 다음과 같다. Bmc tools로 rdp bitmap cache 파싱을 시도한다. 추출된 이미지에서 의심 문자열들을 발견할 수 있고 조합하면 된다. 얻은 플래그는FLAG{s0m3on3_1s_w4tch1n9_my_pc}이다. 문제 이름은 Hidden message이고 풀이과정은 다음과 같다. 주어진 이미지 파일을 stegoveritas 도구로 스테가노그래피 검사를 하면 플래그 이미지 파일이 숨겨진 것을 확인할 수 있다. 얻은 플래그는 FLAG{St3gan09raphy_15_Eazy~~!!}이다. 문제 이름은 Whos the admin now이고 풀이 과정은 다음과 같다. 아무 계정으로 가입을 하고 로그인 과정을 중간에 인터챕트하면 jwt 토큰을 사용하여 인증을 수행하는 것을 확인할 수 있다. 해당 jwt를 뜯어보면 role 항목이 있는데 admin으로 수정하고 검증을 위한 jwks.json을 공격자 서버로 구성하면 로그인 과정을 우회할 수 있다. 형식을 맞춰서 jwt를 전달하면 성공적으로 페이지에 접근이 가능한데 /mypage 항목에서 user_info를 이용하여 XXE공격이 가능하다. 서버 플래그로 유추되는 FLAG 파일에 대한 XXE 페이로드를 작성해서 send하면 플래그를 얻을 수 있다. 얻은 플래그는 FLAG{jku_4nd_xxe_4r3_d4ng3r0u5}이다. 문제 이름은 Invalid otp 이고, 풀이과정은 다음과 같다. 문제 서버로 접속하면 공격할 수 있는 파라미터 자체가 매우 적은데, 이것저것 살펴보면 아래 URL에서 SSRF 취약점이 발생한다. /image_render?url에서 url에 원하는 것을 넣으면 된다. 풀이자의 경우 SSRF 리다이렉트를 이용하여 개인 서버에서 서버 디렉토리를 리스팅하였다. 여기서 원하는 항목을 개인 서버의 메인 코드의 경로에 입력하면 SSRF 리다이렉션으로 내용을 확인할 수 있다 App.py 에서는 admin 계정과 SEED 파일 그리고, OTP 생성 방식에 대한 방법이 나와있다. App.py 코드를 읽어보면 OTP 생성 과정이 다음과 같다. 사용자가 로그인 시도를 하면 session_id가 발급되고 로그인하면서 seed가 생성되어 저장된다. 이때 OTP를 요청하면 서버는 otp_seeds.json에서 session_id에 해당하는 seed를 읽는다. random.Random(seed) 객체를 생성하고 .getrandbits(32)을 호출해서 32비트 랜덤 값을 뽑아내고 그것을 OTP로 사용한다. 파이썬의 random.Random(seed)는 예측이 가능하고, 같은 seed로 초기화하면, 항상 같은 순서로 난수가 나옴 그래서 서버가 지금 뽑은 현재 OTP를 알아내면 이후 나올 OTP 값도 알아낼 수 있다. 먼저 app.py에서 얻은 계정 정보로 로그인을 시도하고 얻은 세션값을 /opt_gen 의 session_id 값으로 전달하여 OTP값을 확인한다. 이후 otp_seeds.json 파일을 읽어 현재 세션에 대한 seed 값을 확인한다. 이후 SEED와 OTP를 넣고 다음 OTP들을 예측할 수 있다. 여기서 다다음 OTP인 1580060504를 메인에서 입력한다. 왜냐면 서버의 /otp_gen 인증할 때 1번 소비되기에 다음 것이 실제 인증에 쓰이는 OTP이다. 인증이 되고, FLAG인 FLAG{55rf_byp455_0tp_prn9_345y_cr4ck3d}를 확인할 수 있다.